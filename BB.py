import streamlit as st
import random
st.set_page_config(page_title="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏ï‡∏ô", page_icon="üîë", layout="centered")

# ---------- ‡∏ò‡∏µ‡∏° UI ----------
st.markdown(
    """
    <style>
    .stApp {
        background-image: url("https://img.freepik.com/free-photo/aesthetic-blue-spectrum-lens-flare-purple-background_53876-104437.jpg");
        background-size: cover;
    }
    h1 {
        color: #ffcc00;
        text-align: center;
    }
    .question {
        font-size: 20px;
        font-weight: bold;
        color: #f5f5f5;
    }
    .option {
        font-size: 18px;
        color: #ffffff;
    }
    .button-container {
        position: fixed;
        bottom: 20px;
        right: 60px;
    }
    </style>
    """,
    unsafe_allow_html=True
)
st.title("SoulSage")

# ---------- ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ----------
journey = [
    {"intro": "üîÆ ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÉ‡∏ô‡πÉ‡∏à‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡πÉ‡∏î‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ù‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏´‡∏≤",
     "question": "üí≠ ‡∏ñ‡πâ‡∏≤‡∏à‡∏¥‡∏ï‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏π‡∏î‡πÑ‡∏î‡πâ ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏ö‡∏≠‡∏Å‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì?",
     "options": ["‡∏â‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πà‡∏á", "‡∏â‡∏±‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏â‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏Ñ‡∏£", "‡∏â‡∏±‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏ö‡∏≤‡∏á‡∏™‡∏¥‡πà‡∏á",
                 "‡∏â‡∏±‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏∞‡∏Å‡πâ‡∏≤‡∏ß‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á"]},

    {"intro": "üåå ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏î‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á... ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô?",
     "question": "‚ú® ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏°‡∏¥‡∏î ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞...",
     "options": ["‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á", "‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ", "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏°‡∏±‡∏ô",
                 "‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô"]},

    {"intro": "üåå ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏î‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á... ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô?",
     "question": "‚ú® ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏°‡∏¥‡∏î ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞...",
     "options": ["‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á", "‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ", "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏°‡∏±‡∏ô",
                 "‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô"]},

    {"intro": "üåå ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏î‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á... ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏î‡∏ß‡∏á‡∏î‡∏≤‡∏ß‡πÅ‡∏ö‡∏ö‡πÑ‡∏´‡∏ô?",
     "question": "‚ú® ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏°‡∏¥‡∏î ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞...",
     "options": ["‡∏™‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á", "‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏∑‡∏î‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ", "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏°‡∏±‡∏ô",
                 "‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô"]},
]

# ---------- ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ----------
if "step" not in st.session_state:
    st.session_state.step = 0
    st.session_state.responses = []

# ---------- Flow: ‡∏Ñ‡∏≥‡πÇ‡∏õ‡∏£‡∏¢ -> ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ----------
if st.session_state.step < len(journey) * 2:
    index = st.session_state.step // 2
    if st.session_state.step % 2 == 0:
        st.write(f"### {journey[index]['intro']}")
    else:
        st.write(f"## {journey[index]['question']}")
        response = st.radio("", journey[index]["options"], key=f"q{index}")
        if response:
            st.session_state.responses.append(response)

    st.markdown("<div class='button-container'>", unsafe_allow_html=True)
    if st.button("üîÆ ‡∏ï‡πà‡∏≠‡πÑ‡∏õ"):
        st.session_state.step += 1
        st.rerun()
    st.markdown("</div>", unsafe_allow_html=True)

# ---------- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ----------
else:
    personalities = ["‡∏ú‡∏π‡πâ‡πÄ‡∏ù‡πâ‡∏≤‡∏î‡∏π", "‡∏ô‡∏±‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á", "‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå", "‡∏ô‡∏±‡∏Å‡∏£‡∏ö‡πÄ‡∏á‡∏≤", "‡∏ú‡∏π‡πâ‡∏´‡∏•‡∏á‡∏•‡∏∑‡∏°", "‡∏ú‡∏π‡πâ‡∏ñ‡∏∑‡∏≠‡πÅ‡∏™‡∏á"]
    personality = random.choice(personalities)
    st.write(f"## üåü ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ **{personality}**")

    # ---------- ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏ä‡∏£‡πå ----------
    share_url = "https://soulsage-personal-app.streamlit.app/"
    st.subheader("üì¢ ‡πÅ‡∏ä‡∏£‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì")
    qr_code_url = f"https://api.qrserver.com/v1/create-qr-code/?size=150x150&data={share_url}"
    st.image(qr_code_url, caption="üì± ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå")

    st.markdown("<div class='button-container'>", unsafe_allow_html=True)
    if st.button("üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà"):
        st.session_state.step = 0
        st.session_state.responses = []
        st.rerun()
    st.markdown("</div>", unsafe_allow_html=True)
